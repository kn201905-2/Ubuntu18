# L2パケットを iptables で捕捉する方法

参考URL：  
https://www.isoppe.jp/?p=6610  
http://sysy.livedoor.biz/archives/9791596.html

以下は不必要かもしれない。iptables で --physdev-in を -A すると、自動的に net.bridge.bridge-nf-call-iptables = 1 となるような感じである。（現時点では不確か、、、）

次回、--physdev-in を試すときがあれば、modprobe 等は用いずに確認してみたい。

```
以下によって、L2パケットを iptables に迂回させるようにする
# modprobe br_netfilter
（br_netfilter を remove する場合は、# modprobe -r br_netfilter）

カーネルパラメータの状態の確認
# sysctl -a | grep net.bridge.bridge-nf-call
net.bridge.bridge-nf-call-arptables = 1
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
```

/etc/sysctl.conf に以下を追加
```
net.bridge.bridge-nf-call-iptables = 1
```

設定反映
```
# /sbin/sysctl -p
```

---
# nftables

* apt install nftables
